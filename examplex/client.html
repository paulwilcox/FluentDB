<script type='module'>

    import { sample, sampleIdb } from "../dist/FluentDB.sample.client.js";
    import $$ from "../dist/FluentDB.client.next.js";

    let result = 
        $$({
            sam: $$.idb('sampleIdb'),
            o: sam => 'orders'
        })
        .filter(o => o.customer == 1)
        .map(o => ({ 
            id: o.id, 
            customer: o.customer, 
            product: o.product,
            rating: o.rating 
        }))
        .group(o => o.rating <= 10)
        .reduce(o => ({ avgRating: $$.avg(o.rating) }))
        .execute(o => o);

    console.log(result);

    fetch('getJson')
    .then(response => response.json())
    .then(json => console.log(json))
    .catch(e => console.log({e}));

</script>

