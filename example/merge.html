<body>

    <div id="beforeMerge" style="display:flex; flex-direction:row"></div><br/>
    <div id="afterMerge" style="display:flex; flex-direction:row"></div><br/>

    <script type='module'>
        
        import { sampleIdb } from "./data.js";
        import { oneQuery } from "../src/oneQuery.js";

        let result = 
            new oneQuery({
                sam: oneQuery.idb('sampleIdb'),
                n: [
                    { id: 1, name: 'taquitos' },
                    { id: 4, name: 'alfredo' },
                    { id: 5, name: 'pizza' }
                ],
                o: [
                    { id: 7, name: 'sandwich' },
                    { id: 8, name: 'egg roll' }
                ]
            })
            .print(sam => 'foods', '#beforeMerge', 'Before: foods')
            .print(n => n, '#beforeMerge', 'Before: n')
            .print(o => o, '#beforeMerge', 'Before: o') // fixme: "Before: o" is being printed twice
            .merge(
                'n', 
                o => o,
                o => o.id 
            )
            .merge(
                sam => 'foods',
                n => n,
                n => n.id  
            )
            .print(n => n, '#afterMerge', 'After: n')
            .print(sam => 'foods', '#afterMerge', 'After: foods')
            .print(o => o, '#afterMerge', 'After: o')
            .executeAll()
            .map('*d');
            
        console.log(result);

    </script>
</body>
