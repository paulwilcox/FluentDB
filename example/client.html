<div id='printDiv'></div>

<script type='module'>

    // TODO: some reconciliation is required between merge logic 
    // for dataset and for idbConnector

    import $$ from '../dist/FluentDB.client.js';
    import sample from '../node_modules/sampledb/dist/sampledb.client.js'; 
    //import sampleIdb from '../node_modules/sampledb/dist/sampledb.idb.js';

    let grouped = 
    $$({ o: sample.orders })
    .group(o => o.customer) // if you don't group, '.reduce' will still output an array (with one item)
    .reduce(o => ({
        customer: $$.first(o.customer), 
        speed: $$.avg(o.speed),
        rating: $$.avg(o.rating),
        speed_cor: $$.cor(o.speed, o.rating)
    }))
    .execute(o => o);

    console.log(grouped);    

/*
    fetch('getMongo')
    .then(response => response.json())
    .then(json => console.log(JSON.stringify(json)))
    .catch(e => console.log({e}));
*/

</script>

