<body>

    <div id='lishResult'></div>   

    <script type='module'> 

        import { customers, sampleIdb } from "./data.js";
        import { lish } from "../src/lish.js";

        new lish(sampleIdb, 'idb')
        .from({
            o: 'orders',
            p: 'products',
            c: customers
        })
        .filter(o => o.product != 123456) 
        .join( 
            { inner: (o,p) => o.product == p.id },
            { left: (o,c) => o.customer == c.id }
        )
        .orderBy((o,p) => o.product)
        .groupBy(o => o.product)
        .fold('f', {
            product:        lish.key(o => o.product),
            revenue:        lish.sum(p => p.price), 
            transactions:   lish.count(p => p.price),
            avgRating:      lish.avg(o => o.rating),
            stdRating:      lish.std(o => 
                                o.rating,
                                x => Math.round(x * 100) / 100
                            ),
            corSR:          lish.cor(
                                o => [o.speed, o.rating], 
                                x => Math.round(x * 100) / 100
                            )
        })
        .print(f => f, '#lishResult', 'Lish Result');

    </script>

</body>