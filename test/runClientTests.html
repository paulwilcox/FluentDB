<script type='module'>

    import sample from './dist/sampleData.client.js';
    import sampleIdb from './dist/sampleData.idb.js';
    import $$ from './dist/FluentDB.client.next.js';
    import tests from './test/tests.js';

    let testsFunc = (testName, fdbFunc) => () => tests(testName, fdbFunc);

    let clientTests = testsFunc('client', () => 
        $$({ 
            o: sample.orders,
            p: sample.products,
            c: sample.customers,
            pc: sample.potentialCustomers,
            s: sample.shoplifters
        })
    );

    let idbTests = testsFunc('idb', () => 
        $$({ 
            sam: $$.idb('sampleData'),
            o: sam => 'orders',
            p: sam => 'products',
            c: sam => 'customers',
            pc: sam => 'potentialCustomers',
            s: sam => 'shoplifters'
        })
    );

    let hybridLeft = testsFunc('clientHybridLeft', () => 
        $$({
            sam: $$.idb('sampleData'),
            o: sample.orders,
            p: sam => 'products',
            c: sample.customers,
            pc: sam => 'potentialCustomers',
            s: sam => 'shoplifters'
        })
    );

    let hybridRight = testsFunc('clientHybridRight', () => 
        $$({
            sam: $$.idb('sampleData'),
            o: sam => 'orders',
            p: sample.products,
            c: sam => 'customers',
            pc: sample.potentialCustomers,
            s: sample.shoplifters 
        })
    );

    sampleIdb('sampleData', true) // resets sampleData in IndexedDB
    .then(() => Promise.all([clientTests(), idbTests(), hybridLeft(), hybridRight()]))
    .then(seri => {
        for(let series of seri)
        for(let test of series)
            console.log(`test ${test.seriesName}.${test.name} ${test.passStatus}`);
    })
    .then(() => console.log('done:client.tests'));

</script>